---
title: "Ã¥ngstromCTF 2021 - Keysar v2"
emoji: "ðŸ˜º"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["CTF", "Crypto", "Easy"]
published: true
---

### å•é¡Œæ¦‚è¦
> Wow! Aplet sent me a message... he said he encrypted it with a key, but lost it. Gotta go though, I have biology homework!
>
> [Source](https://files.actf.co/45d2f41c58c51d0e7eeeac6b4fae4b01fca1427bd8e8d2cf5a127b8d7abfcdee/chall.py) [Output](https://files.actf.co/8125825ae0a5c81fe0f3e4520b95c02937a4d6624929afec84e451366ede6552/out.txt)

```python:chall.py
import string

with open("key.txt", "r") as f:
    shift = int(f.readline())
    key = f.readline()

with open("flag.txt", "r") as f:
    flag = f.read()


stdalph = string.ascii_lowercase
rkey = ""

for i in key:
    if i not in rkey:
        rkey += i
for i in stdalph:
    if i not in rkey:
        rkey += i
rkey = rkey[-shift:] + rkey[:-shift]

enc = ""
for a in flag:
    if a in stdalph:
        enc += rkey[stdalph.index(a)]
    else:
        enc += a

print(enc)
```

ã‚·ãƒ¼ã‚¶ãƒ¼æš—å·ã«ä¼¼ãŸã‚ˆã†ãªæ„Ÿã˜ã«æ„Ÿã˜ã¾ã™ãŒã€ãã‚Œä»¥å‰ã«ç½®æ›æš—å·ã¨æ‰ãˆãŸã»ã†ãŒã‚ˆã•ãã†ã€‚

### è§£èª¬
ç½®æ›æš—å·ã¯å˜èªžã®é•·ã•ã‹ã‚‰æŽ¨æ¸¬ã™ã‚‹ç­‰ã®æ”»æ’ƒãŒæœ‰åŠ¹ã ã£ãŸã‚Šã—ã¾ã™ã€‚ä¾‹ãˆã°1æ–‡å­—ã®å˜èªžã¯"a"ã‚‚ã—ãã¯"I"ã§ã‚ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã€ç­‰ã€‚

ã¨ã„ã†ã“ã¨ã§ã€ç½®æ›ç†ç”±ã‚’ã¾ã¨ã‚ãªãŒã‚‰ç½®æ›ã—ã¦å‡ºåŠ›ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒã“ã¡ã‚‰ã€‚ç½®æ›ã¯å‡ºåŠ›çµæžœã‚’è¦‹ãªãŒã‚‰ç¢ºå®šã—ãŸæ–‡å­—ï¼ˆèµ¤ãè¡¨ç¤ºï¼‰ã‹ã‚‰æ¬¡ã®æŽ¨æ¸¬ã‚’ã—ã¦ã„ãæ„Ÿã˜ã§ã™ã€‚

```python:solve.py
swap_list = [
        # flag format: actf{...}
        ("q", "a"),
        ("u", "c"),
        ("f", "t"),
        ("x", "f"),
        # I
        ("b", "i"),
        # that
        ("z", "h"),
        # it's, that's
        ("d", "s"),
        # hitchhiqwv -> hitchhike?
        ("q", "k"),
        ("w", "e"),
        # tx, xf -> to, of
        ("x", "o"),
        # cam't -> can't
        ("m", "n"),
        # kno?n -> known???
        ("q", "w"),
        # the?e -> there???
        ("u", "r"),
        # c?ass -> class???
        ("b", "l"),
        # ?lack an? ?ellow! -> black and yellow!?
        ("d", "b"),
        ("v", "d"),
        ("x", "y"),
        # welco?e -> welcome
        ("u", "m"),
        # I told yo? -> I told you?
        ("g", "u"),
]

with open("out.txt", "r") as f:
    s = list(f.read())
    for i in range(len(s)):
        for swap in swap_list:
            if s[i] == swap[0]:
                s[i] = "\033[31m" + swap[1] + "\033[0m"
                break
            elif s[i] == swap[1]:
                s[i] = swap[0]
    print("".join(s))
```
