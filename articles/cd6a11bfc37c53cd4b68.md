---
title: "Ã¥ngstromCTF 2021 - Exclusive Cipher"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["CTF", "Crypto", "Easy"]
published: true
---

### å•é¡Œæ¦‚è¦
> Clam decided to return to classic cryptography and revisit the XOR cipher! Here's some hex encoded ciphertext:
>
> `ae27eb3a148c3cf031079921ea3315cd27eb7d02882bf724169921eb3a469920e07d0b883bf63c018869a5090e8868e331078a68ec2e468c2bf13b1d9a20ea0208882de12e398c2df60211852deb021f823dda35079b2dda25099f35ab7d218227e17d0a982bee7d098368f13503cd27f135039f68e62f1f9d3cea7c`
> The key is 5 bytes long and the flag is somewhere in the message.

XORæš—å·ï¼ˆæ­£å¼åç§°ã‹ä¸æ˜ï¼‰ã§ã™ã€‚

### è§£èª¬
ãƒ’ãƒ³ãƒˆã¨ã—ã¦ã‚ã‚Šãã†ãªã®ã¯ã€ŒThe key is 5 bytes longã€ã§ã™ã€‚éµãŒ5æ–‡å­—ãªã®ã§å…¨æ¢ç´¢å‡ºæ¥ãã†ï¼Ÿã¨æ€ã„ã¾ã™ãŒã€1æ–‡å­—è¾ºã‚Š7bitã‚ã‚‹ã®ã§ã€å…¨æ¢ç´¢ã™ã‚‹ã¨$(2^7)^5=34,359,738,368$ã€‚æ™‚é–“ã‹ã‘ã‚Œã°å‡ºæ¥ãã†ãªæ°—ã‚‚ã—ã¾ã™ãŒã€å•é¡Œã®é›£æ˜“åº¦ã«ã—ã¦ã¯éç¾å®Ÿçš„ã§ã™ã­ã€‚

è€ƒãˆã‚‹ã¹ãã¯flagã®å…ˆé ­ãŒ`actf{`ã§å§‹ã¾ã£ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã§ã€ã“ã®æ–‡å­—åˆ—ãŒä¸ãˆã‚‰ã‚Œã¦ã„ã‚‹æš—å·ã®ã©ã“ã«ã‚ã‚‹ã‹ã‚’å…¨æ¢ç´¢ã™ã‚‹ã“ã¨ã§éµã‚’æ˜ã‚‰ã‹ã«å‡ºæ¥ã¾ã™ã€‚ä¾‹ãˆã°ä¸€ç•ªæœ€åˆã®5æ–‡å­—ãŒ`actf{`ã§ã‚ã‚‹ã¨ä»®å®šã™ã‚‹ã¨ã€éµã¯æš—å·ã¨XORã—ã¦`\x00\x06\x46\x51\x1e`ã«ãªã‚Šã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«`actf{`ã®ä½ç½®ã§å…¨æ¢ç´¢ã™ã‚‹ã¨ç¾å®Ÿçš„ãªç¯„å›²ã§flagã‚’æ¢ã›ã¾ã™ã€‚æœ€å¾Œã«flagå€™è£œãŒå¤§é‡ã«å‡ºã¦ãã‚‹ã®ã§ãã‚Œã£ã½ã„ã®ã‚’ç›®grepã—ã¦çµ‚äº†ã€‚

```python:solve.py
c = bytes.fromhex("ae27eb3a148c3cf031079921ea3315cd27eb7d02882bf724169921eb3a469920e07d0b883bf63c018869a5090e8868e331078a68ec2e468c2bf13b1d9a20ea0208882de12e398c2df60211852deb021f823dda35079b2dda25099f35ab7d218227e17d0a982bee7d098368f13503cd27f135039f68e62f1f9d3cea7c")
# header: actf{...}
for start in range(5, len(c)):
    keys = []
    keys.append(c[start - 5] ^ ord("a"))
    keys.append(c[start - 4] ^ ord("c"))
    keys.append(c[start - 3] ^ ord("t"))
    keys.append(c[start - 2] ^ ord("f"))
    keys.append(c[start - 1] ^ ord("{"))
    m = b"actf{"
    for i in range(len(c) - start):
        m += (keys[i % 5] ^ c[i + start]).to_bytes(1, "big")
    if b"{" in m:
        print(m)
```
