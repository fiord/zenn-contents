---
title: "DiceCTF 2021 - babymix"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["CTF", "Reb", "Easy"]
published: true
---

## å•é¡Œæ¦‚è¦
> Just the right mix of characters will lead you to the flag :)
> 
> [babymix](https://dicegang.storage.googleapis.com/uploads/3821fb32cc49474f2431d2c27e3c696c856e57dcd719d5c0bd3739435afc755a/babymix)

å…¸å‹çš„ãªRev-Warmupã‹ãªã¨æ€ã„ã¾ã™ã€‚

## è§£èª¬
å–ã‚Šæ•¢ãˆãšé©å½“ãªãƒ„ãƒ¼ãƒ«ï¼ˆä»Šå›ã¯ghidraï¼‰ã§å¯è¦–åŒ–ã—ã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

1. å®Ÿè¡Œã™ã‚‹ã¨flagã®å…¥åŠ›ã‚’è¦æ±‚ã—ã€å…¥åŠ›ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹åˆ¤åˆ¥ã—ã¦ãã‚Œã‚‹
2. ãŸã ã—ã€ãã®åˆ¤åˆ¥ãŒè¤‡é›‘ã§ã€è¤‡æ•°ã®é–¢æ•°ã«å°‘ã—ãšã¤æ›¸ã‹ã‚Œã¦ã„ã‚‹å¼ã‚’é€£ç«‹ã—ã¦è§£ãå¿…è¦ãŒã‚ã‚‹ã€‚

é–¢æ•°ã®æ•°ãŒã¾ãã¾ãå¤šãã€æ‰‹ã§å¼ã‚’ã¾ã¨ã‚ã‚‹ã«ã¯é¢å€’ã§ã™ã€‚ã“ã®ã‚ˆã†ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«å¯¾ã—ã¦ã¯angrã«ã‚ˆã‚‹è§£æãŒæœ‰åŠ¹ãã†ãªã®ã§è„³æ­»angrã‚²ãƒ¼ã‚’å§‹ã‚ã¾ã™ã€‚

```python:solve.py
import angr
import claripy
from logging import getLogger, WARN
getLogger("angr").setLevel(WARN + 1)

p = angr.Project("./babymix")
state = p.factory.entry_state()
simgr = p.factory.simulation_manager(state)

simgr.explore(find=lambda s: b"Correct!" in s.posix.dumps(1),
    avoid=lambda s: b"\nIncorrect :(" in s.posix.dumps(1))
try:
  found = simgr.found[0]
  print("flag:", found.posix.dumps(0))
except IndexError:
  print("flag not found")
```

ã“ã‚Œã‚’å‹•ã‹ã—ã¦æ”¾ç½®ã™ã‚‹ã¨è§£ã‘ã¾ã™ã€‚

```bash
$ docker pull angr/angr
$ docker run -v [path-to-babymix-and-solve.py]:/tmp/babymix --name test -it angr/angr /bin/sh
$ cd /tmp/babymix
$ python solve.py
```

